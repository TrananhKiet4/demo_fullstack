<script>
  const API = "/api/students";

  // ✅ KHAI BÁO TRƯỚC
  const nameInput = document.getElementById("name");
  const ageInput = document.getElementById("age");
  const emailInput = document.getElementById("email");
  const tbody = document.getElementById("students");

  document.addEventListener("DOMContentLoaded", loadStudents);

  async function loadStudents() {
    const res = await fetch(API);
    const data = await res.json();

    tbody.innerHTML = "";

    data.forEach(s => {
      tbody.innerHTML += `
        <tr>
          <td>${s.id}</td>
          <td>${s.name}</td>
          <td>${s.age}</td>
          <td>${s.email}</td>
          <td>
            <button onclick="del(${s.id})">❌</button>
          </td>
        </tr>
      `;
    });
  }

  async function addStudent() {
    await fetch(API, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        name: nameInput.value,
        age: ageInput.value,
        email: emailInput.value
      })
    });

    nameInput.value = "";
    ageInput.value = "";
    emailInput.value = "";

    loadStudents();
  }

  async function del(id) {
    await fetch(API + "/" + id, { method: "DELETE" });
    loadStudents();
  }
</script>